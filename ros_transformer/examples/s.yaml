edition: 3.0.0 #  命令行YAML规范版本，遵循语义化版本（Semantic Versioning）规范
name: rosApp #  项目名称
access: xiliu #  秘钥别名

resources:
  xl_test_bucket_001:
    component: aliyun_oss_bucket@dev
    props:
      bucket: xl-test-bucket-001
      acl: private
  
  xl_test_instance_002:
    component: aliyun_ots_instance@dev
    props:
      name: xl-inst-321
      accessed_by: Any
      description: "xiliu test instance"
      instance_type: Capacity

  xl_test_table_001:
    component: aliyun_ots_table@dev
    props:
      depends_on: 
        - xl_test_instance_002
      instance_name: ${xl_test_instance_002.props.name}
      table_name: app_table
      primary_key:
        - type: String
          name: id
      time_to_live: -1
      max_version: 1
      deviation_cell_version_in_sec: 86400

  xl_test_log_project_001: 
    component: aliyun_sls_project@dev
    props:
      name: xl-test-project
      description: "xiliu test log project"

  xl_test_log_store_001: 
    component: aliyun_sls_logstore@dev
    props:
      depends_on: 
        - xl_test_log_project_001
      project: xl-test-project
      name: xl-test-logs
      retention_period: 15
      shard_count: 1
      auto_split: true
      max_split_shard_count: 12
      enable_web_tracking: false
      append_meta: false

  xl_test_vpc_001:
    component: aliyun_vpc@dev
    props:
      vpc_name: xl_test_vpc_001
      cidr_block: 192.168.6.0/24
      description: a test vpc

  xl_test_vswitch_001:
    component: aliyun_vswitch@dev
    props:
      depends_on: 
        - xl_test_vpc_001
      vswitch_name : xl_test_vswitch_001
      cidr_block: 192.168.6.0/25
      vpc_id: ${xl_test_vpc_001.output.vpcId}
      zone_id: cn-hangzhou-k
      description: a test vswitch

  ros-transformer-test: #  服务名称
    component: ${path("../")}
    props:
      region: cn-hangzhou
      name: xl-stack-transformer1
      endpoint: ros.aliyuncs.com # 海外是 ros-intl.aliyuncs.com， 默认是国内
      refs:
        - ${xl_test_bucket_001.output}
        - ${xl_test_instance_002.output}
        - ${xl_test_table_001.output}
        - ${xl_test_log_project_001.output}
        - ${xl_test_log_store_001.output}
        - ${xl_test_vpc_001.output}
        - ${xl_test_vswitch_001.output}